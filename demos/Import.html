<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Import</title>
</head>
<body>
<link href="../src/nimiq-style.css" rel="stylesheet">

<div>
    <button id="import-words">Import from words</button>
    <button id="import-file">Import from file</button>
</div>

<script>
    document.querySelector('#import-words').addEventListener('click', () => requestImport('words'));
    document.querySelector('#import-file').addEventListener('click', () => requestImport('file'));

    async function requestImport(type) {
        const keyguard = window.open(`../src/request/import-${type}/`, 'keyguard');

        // We need this check because we call the rpcServer object directly and not via RPC Client
        function checkIfKeyguardReady(resolve) {
            if (keyguard.rpcServer !== undefined) {
                resolve();
            } else {
                self.setTimeout(() => checkIfKeyguardReady(resolve), 25);
            }
        }
        await new Promise(res => checkIfKeyguardReady(res));

        try {
            const result = await keyguard.rpcServer.request({
                defaultKeyPath: "m/242'/0'/0'"
            });
            console.log('Keyguard result', result);
        } catch (e) {
            console.error(e);
        }

        keyguard.close();
    }
</script>

</body>
</html>
